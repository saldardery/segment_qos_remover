import json
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)


url = "https://nsxt01-wld-01.corp.local/policy/api/v1/infra/segments"

payload = {}
headers = {'Authorization': 'Basic YWRtaW46Vk13YXJlMTIzIVZNd2FyZTEyMyE='}

response = requests.request("GET", url, headers=headers, data=payload,verify=False)
json_data = response.json()
file_path="test.json"
z=0
with open(file_path, 'w') as json_file:
    json.dump(json_data, json_file)
#print(json_data["results"][1]["id"])
for i in json_data["results"]:
    segment_name=json_data["results"][z]["id"]
    qos_url = "https://nsxt01-wld-01.corp.local/policy/api/v1/infra/segments/"+segment_name+"/segment-qos-profile-binding-maps"
    qos_response = requests.request("GET", qos_url, headers=headers, data=payload,verify=False)
    qos_response=qos_response.json()
    if(qos_response["result_count"]==1):
        print("yes!")
    #print(qos_response["results"][0]["qos_profile_path"])
    z=z+1

